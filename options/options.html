<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QBittorrent Remote Connection - Settings</title>
    <link href="../vendor/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="../vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet" />
    <link rel="stylesheet" href="../css/options.css" />
  </head>
  <body class="bg-dark text-light">
    <div class="container py-4" style="max-width: 800px">
      <header class="mb-4">
        <h1 class="display-6 text-primary">
          <i class="bi bi-cloud-arrow-down me-3"></i>QBittorrent Remote Connection
        </h1>
        <p class="lead text-muted">
          Configure your QBittorrent server connection settings
        </p>
      </header>

      <main>
        <!-- Connection Status Card -->
        <div id="connectionStatusCard" class="card bg-dark border-success mb-4" style="display: none;">
          <div class="card-header bg-success">
            <h3 class="h6 mb-0 text-white">
              <i class="bi bi-check-circle me-2"></i><span id="connectionStatusTitle">Connected to QBittorrent</span>
            </h3>
          </div>
          <div class="card-body">
            <div class="row text-center">
              <div class="col-md-3">
                <div class="d-flex flex-column">
                  <span class="text-muted small">Server</span>
                  <span id="statusServerUrl" class="font-monospace text-info fw-bold">-</span>
                </div>
              </div>
              <div class="col-md-3">
                <div class="d-flex flex-column">
                  <span class="text-muted small">Version</span>
                  <span id="statusServerVersion" class="font-monospace text-success fw-bold">-</span>
                </div>
              </div>
              <div class="col-md-3">
                <div class="d-flex flex-column">
                  <span class="text-muted small">Torrents</span>
                  <span id="statusTorrentCount" class="font-monospace text-warning fw-bold">-</span>
                </div>
              </div>
              <div class="col-md-3">
                <div class="d-flex flex-column">
                  <span class="text-muted small">Last Check</span>
                  <span id="statusLastCheck" class="font-monospace text-muted small">-</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <form id="configForm">
          <div class="card bg-dark border-secondary mb-4">
            <div class="card-header bg-primary">
              <h2 class="h5 mb-0 text-white">
                <i class="bi bi-server me-2"></i>Server Configuration
              </h2>
            </div>
            <div class="card-body">
              <div class="mb-3">
                <label for="serverUrl" class="form-label">
                  <i class="bi bi-globe me-1"></i>Server URL/IP Address:
                </label>
                <input type="text" class="form-control bg-dark border-secondary text-light" id="serverUrl" name="serverUrl" placeholder="192.168.1.100 or qbittorrent.local" required>
                <div class="form-text">Enter the IP address or hostname of your QBittorrent server</div>
              </div>

              <div class="mb-3">
                <label for="port" class="form-label">
                  <i class="bi bi-ethernet me-1"></i>Port:
                </label>
                <input type="number" class="form-control bg-dark border-secondary text-light" id="port" name="port" placeholder="8080" min="1" max="65535" required>
                <div class="form-text">Default QBittorrent Web UI port is 8080</div>
              </div>

              <div class="form-check mb-3">
                <input class="form-check-input" type="checkbox" id="useHttps" name="useHttps">
                <label class="form-check-label" for="useHttps">
                  <i class="bi bi-shield-lock me-1"></i>Use HTTPS (SSL/TLS)
                </label>
                <div class="form-text">Enable if your QBittorrent server uses HTTPS</div>
              </div>
            </div>
          </div>

          <div class="card bg-dark border-secondary mb-4">
            <div class="card-header bg-warning text-dark">
              <h2 class="h5 mb-0">
                <i class="bi bi-person-lock me-2"></i>Authentication
              </h2>
            </div>
            <div class="card-body">
              <div class="mb-3">
                <label for="username" class="form-label">
                  <i class="bi bi-person me-1"></i>Username:
                </label>
                <input type="text" class="form-control bg-dark border-secondary text-light" id="username" name="username" autocomplete="username">
                <div class="form-text">QBittorrent Web UI username</div>
              </div>

              <div class="mb-3">
                <label for="password" class="form-label">
                  <i class="bi bi-key me-1"></i>Password:
                </label>
                <input type="password" class="form-control bg-dark border-secondary text-light" id="password" name="password" autocomplete="current-password">
                <div class="form-text">QBittorrent Web UI password</div>
              </div>

              <div class="form-check mb-3">
                <input class="form-check-input" type="checkbox" id="autoLogin" name="autoLogin">
                <label class="form-check-label" for="autoLogin">
                  <i class="bi bi-key-fill me-1"></i>Auto-login when extension opens
                </label>
                <div class="form-text">Automatically authenticate when using the extension</div>
              </div>
            </div>
          </div>

          <div class="d-grid gap-2 d-md-flex justify-content-md-center mb-4">
            <button type="button" id="testConnection" class="btn btn-outline-warning btn-lg">
              <span class="btn-text">
                <i class="bi bi-lightning me-2"></i>Test Connection
              </span>
              <span class="spinner-border spinner-border-sm" style="display: none;" role="status"></span>
            </button>
            <button type="submit" id="saveConfig" class="btn btn-primary btn-lg">
              <span class="btn-text">
                <i class="bi bi-check-circle me-2"></i>Save Configuration
              </span>
              <span class="spinner-border spinner-border-sm" style="display: none;" role="status"></span>
            </button>
          </div>
        </form>

        <div id="statusMessage" class="alert border-0" style="display: none;" role="alert">
          <span class="status-text"></span>
        </div>

        <div class="card bg-dark border-secondary mt-4">
          <div class="card-header bg-success">
            <h3 class="h6 mb-0 text-white">
              <i class="bi bi-list-check me-2"></i>Quick Setup Guide
            </h3>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-6 mb-3">
                <h6 class="text-success">
                  <i class="bi bi-gear me-1"></i>QBittorrent Setup
                </h6>
                <ol class="small">
                  <li>Open QBittorrent application</li>
                  <li>Go to <code>Tools â†’ Options</code></li>
                  <li>Click <code>Web UI</code> tab</li>
                  <li>Enable <code>Web User Interface</code></li>
                  <li>Note the port number (usually 8080)</li>
                  <li>Set username/password if needed</li>
                </ol>
              </div>
              <div class="col-md-6 mb-3">
                <h6 class="text-warning">
                  <i class="bi bi-shield-exclamation me-1"></i>Firefox Setup
                </h6>
                <ol class="small">
                  <li>Open Firefox Settings</li>
                  <li>Go to <code>Privacy & Security</code></li>
                  <li>Find <code>HTTPS-Only Mode</code></li>
                  <li><strong>Turn it OFF completely</strong></li>
                  <li>Restart Firefox browser</li>
                </ol>
              </div>
            </div>
            
            <div class="alert alert-info border-info mt-3 mb-0">
              <h6 class="alert-heading">
                <i class="bi bi-lightbulb me-1"></i>Troubleshooting Tips
              </h6>
              <div class="row">
                <div class="col-md-6">
                  <ul class="mb-0 small">
                    <li><strong>NetworkError:</strong> Disable Firefox HTTPS-Only Mode</li>
                    <li><strong>Connection refused:</strong> Enable QBittorrent Web UI</li>
                    <li><strong>401 Unauthorized:</strong> Check username/password</li>
                  </ul>
                </div>
                <div class="col-md-6">
                  <ul class="mb-0 small">
                    <li><strong>Timeout:</strong> Check server IP address and port</li>
                    <li><strong>CORS errors:</strong> Use local IP (192.168.x.x)</li>
                    <li><strong>Still not working:</strong> Try port 8080 or check firewall</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <script src="../vendor/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="../js/options.js"></script>
  </body>
</html>
